<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤ OPD - ‡∏£‡∏û.‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå</title>

    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    
    <meta name="theme-color" content="#8b5cf6">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-50 min-h-screen">

    <div id="initial-loader" class="popup-overlay" style="display: flex;">
        <div class="popup-loading">
            <div class="spinner"></div>
            <div class="popup-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
        </div>
    </div>

    <header class="bg-white shadow-md relative z-20">
        <div class="container mx-auto px-6 py-4">
            <h1 class="text-3xl font-bold text-gray-800 text-center">üè• ‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤ OPD - ‡∏£‡∏û.‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå</h1>
            <div class="text-center mt-2">
                <span id="db-status" class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium">‚è≥ Connecting</span>
            </div>
        </div>
        <div id="datetime-display" class="absolute top-4 right-6 text-sm font-semibold text-amber-800 bg-amber-200 px-3 py-1 rounded-lg shadow hidden md:block"></div>
    </header>

    <button id="menu-toggle" onclick="toggleSidebar()" class="fixed top-4 left-4 z-50 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg shadow-lg transition-all duration-300 flex items-center space-x-2">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        <span>‡πÄ‡∏°‡∏ô‡∏π</span>
    </button>

    <nav id="sidebar" class="fixed left-0 top-0 h-full w-80 bg-white shadow-2xl transform -translate-x-full transition-transform duration-300 ease-in-out z-40 overflow-y-auto">
        <div class="p-6 border-b border-gray-200"><h2 class="text-xl font-bold text-gray-800">‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</h2></div>
        <div class="p-4 space-y-3">
            <button onclick="showTab('hourly')" class="menu-item menu-item-blue w-full text-left bg-white rounded-xl p-4 shadow-md" id="hourly-tab">
                <div class="flex items-center"><div class="text-3xl mr-4">‚è∞</div><div><h3 class="text-lg font-semibold text-gray-800">‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</h3><p class="text-sm text-gray-600">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</p></div></div>
            </button>
            <button onclick="showTab('leave')" class="menu-item menu-item-orange w-full text-left bg-white rounded-xl p-4 shadow-md" id="leave-tab">
                <div class="flex items-center"><div class="text-3xl mr-4">üì¢</div><div><h3 class="text-lg font-semibold text-gray-800">‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤/‡∏•‡∏≤‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤</h3><p class="text-sm text-gray-600">‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ï‡πà‡∏≤‡∏á‡πÜ</p></div></div>
            </button>
            <button onclick="showTab('calendar')" class="menu-item menu-item-purple w-full text-left bg-white rounded-xl p-4 shadow-md" id="calendar-tab">
                <div class="flex items-center"><div class="text-3xl mr-4">üìÖ</div><div><h3 class="text-lg font-semibold text-gray-800">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤</h3><p class="text-sm text-gray-600">‡∏î‡∏π‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p></div></div>
            </button>
            <button onclick="showTab('register')" class="menu-item menu-item-green w-full text-left bg-white rounded-xl p-4 shadow-md" id="register-tab">
                <div class="flex items-center"><div class="text-3xl mr-4">üë§</div><div><h3 class="text-lg font-semibold text-gray-800">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3><p class="text-sm text-gray-600">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà</p></div></div>
            </button>
            <button onclick="showTab('pin')" class="menu-item menu-item-yellow w-full text-left bg-white rounded-xl p-4 shadow-md" id="pin-tab">
                <div class="flex items-center"><div class="text-3xl mr-4">üîë</div><div><h3 class="text-lg font-semibold text-gray-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ PIN</h3><p class="text-sm text-gray-600">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô PIN ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß/‡∏£‡∏∞‡∏ö‡∏ö</p></div></div>
            </button>
            <button onclick="openBackupMenu()" class="menu-item menu-item-green w-full text-left bg-white rounded-xl p-4 shadow-md">
                <div class="flex items-center">
                    <div class="text-3xl mr-4">üíæ</div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800">Backup ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <p class="text-sm text-gray-600">Excel / JSON</p>
                    </div>
                </div>
            </button>
            <button onclick="showTab('admin-dashboard')" class="menu-item menu-item-gray w-full text-left bg-white rounded-xl p-4 shadow-md" id="admin-dashboard-tab">
                <div class="flex items-center">
                    <div class="text-3xl mr-4">üëë</div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800">Admin Dashboard</h3>
                        <p class="text-sm text-gray-600">‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</p>
                    </div>
                </div>
            </button>
        </div>
    </nav>

    <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden" onclick="closeSidebar()"></div>

    <main class="container mx-auto px-6 pb-8 pt-20">
        <div class="main-content-wrapper">
            
            <div id="hourly-content" class="tab-content hidden">
                <div class="form-wrapper-animated">
                    <div class="container-animated">
                        <div class="header-animated">
                            <h1>‚è∞ ‡∏•‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</h1>
                            <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</p>
                        </div>
                        
                        <div class="form-container-animated">
                            <form id="hourly-form">
                                <div class="form-group-animated">
                                    <label for="hourly-user">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
                                    <select id="hourly-user" required></select>
                                </div>
                                <div class="form-group-animated">
                                    <label class="block text-gray-700 text-sm font-bold mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</label>
                                    <div class="radio-group-animated">
                                        <label class="radio-option-animated leave-hour" data-type="leave">
                                            <input type="radio" name="hourlyLeaveType" value="leave" class="hidden" required>
                                            <span class="radio-label">‡∏•‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</span>
                                        </label>
                                        <label class="radio-option-animated use-hour" data-type="use">
                                            <input type="radio" name="hourlyLeaveType" value="use" class="hidden" required>
                                            <span class="radio-label">‡πÉ‡∏ä‡πâ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group-animated">
                                    <label for="hourly-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                                    <input type="date" id="hourly-date" required>
                                </div>
                                <div class="form-group-animated">
                                    <div class="time-group-animated">
                                        <div><label for="hourly-start">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label><input type="time" id="hourly-start" required></div>
                                        <div><label for="hourly-end">‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label><input type="time" id="hourly-end" required></div>
                                    </div>
                                </div>
                                <div class="form-group-animated">
                                    <label for="hourly-approver">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</label>
                                    <select id="hourly-approver" required></select>
                                </div>
                                <div class="form-group-animated">
                                    <label for="hourly-note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                                    <textarea id="hourly-note" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
                                </div>
                                <div class="form-group-animated">
                                    <button type="submit" class="submit-btn-animated">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
               <div class="grid grid-cols-1 md:grid-cols-2 gap-6 my-8">
                    <div class="podium-card">
                        <h1 class="podium-title">üèÜ Top 3 ‡∏ï‡∏¥‡∏î‡∏•‡∏ö üèÜ</h1>
                        <div id="negative-ranking" class="podium-wrapper"></div>
                    </div>
                    <div class="podium-card">
                        <h1 class="podium-title">ü•á Top 3 ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ü•á</h1>
                        <div id="positive-ranking" class="podium-wrapper"></div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-gray-800">‡∏™‡∏£‡∏∏‡∏õ‡∏•‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</h3>
                         <div class="flex items-center space-x-4">
                            <div>
                                <label for="hourly-summary-filter-position" class="text-sm font-medium text-gray-700 mr-2">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:</label>
                                <select id="hourly-summary-filter-position" class="p-2 border rounded-lg text-sm">
                                    <option value="">‡∏ó‡∏∏‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option>
                                    <option value="‡πÄ‡∏†‡∏™‡∏±‡∏ä">‡πÄ‡∏†‡∏™‡∏±‡∏ä</option>
                                    <option value="‡∏à‡∏û‡∏á">‡∏à‡∏û‡∏á</option>
                                    <option value="‡∏à‡∏ô‡∏ó">‡∏à‡∏ô‡∏ó</option>
                                </select>
                            </div>
                             <div>
                                 <label for="hourly-filter-fiscal-year" class="text-sm font-medium text-gray-700 mr-2">‡∏õ‡∏µ‡∏á‡∏ö:</label>
                                <select id="hourly-filter-fiscal-year"></select>
                            </div>
                        </div>
                    </div>
                    <div class="overflow-x-auto"><table class="w-full table-auto"><thead class="bg-gray-50"><tr><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡∏•‡∏≤</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ú‡∏•‡∏£‡∏ß‡∏°</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th></tr></thead><tbody id="hourly-summary-table"></tbody></table></div>
                    <div id="hourly-summary-pagination-controls" class="flex justify-between items-center mt-4">
                        <button id="hourly-summary-prev-btn" onclick="changeHourlySummaryPage(-1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-l disabled:opacity-50" disabled>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
                        <span id="hourly-summary-page-info" class="text-sm"></span>
                        <button id="hourly-summary-next-btn" onclick="changeHourlySummaryPage(1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-r disabled:opacity-50">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h3>
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 p-4 border rounded-lg bg-gray-50">
                        <input type="text" id="hourly-search-name" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠..." class="p-2 border rounded-lg col-span-1 md:col-span-2">
                        <select id="hourly-filter-position" class="p-2 border rounded-lg"><option value="">‡∏ó‡∏∏‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option><option value="‡πÄ‡∏†‡∏™‡∏±‡∏ä">‡πÄ‡∏†‡∏™‡∏±‡∏ä</option><option value="‡∏à‡∏û‡∏á">‡∏à‡∏û‡∏á</option><option value="‡∏à‡∏ô‡∏ó">‡∏à‡∏ô‡∏ó</option></select>
                        <input type="date" id="hourly-filter-start" class="p-2 border rounded-lg">
                        <input type="date" id="hourly-filter-end" class="p-2 border rounded-lg">
                    </div>
                    <div class="overflow-x-auto"><table class="w-full table-auto"><thead class="bg-gray-50"><tr><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡πÄ‡∏ß‡∏•‡∏≤</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead><tbody id="hourly-records-table"></tbody></table></div>
                    <div id="hourly-pagination-controls" class="flex justify-between items-center mt-4"><button id="hourly-prev-btn" onclick="changeHourlyPage(-1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-l disabled:opacity-50" disabled>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button><span id="hourly-page-info" class="text-sm"></span><button id="hourly-next-btn" onclick="changeHourlyPage(1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-r disabled:opacity-50">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button></div>
                </div>
            </div>

            <div id="leave-content" class="tab-content hidden">
                <div class="form-wrapper-animated">
                    <div class="container-animated">
                        <div class="header-animated-orange">
                            <a href="http://122.154.234.182:3001/authen?redirect=http://122.154.234.182:3001/leave/p&name=%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%9A%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B8%A5%E0%B8%B2" target="_blank" rel="noopener noreferrer" 
                               class="absolute top-4 right-4 z-10 flex items-center space-x-2 bg-gradient-to-br from-teal-400 to-cyan-500 hover:from-teal-500 hover:to-cyan-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:-translate-y-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z" />
                                    <path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z" />
                                </svg>
                                <span>‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏≤ ‡∏£‡∏û.</span>
                            </a>
                            <h1>üì¢ ‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤/‡∏•‡∏≤‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤</h1>
                            <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</p>
                            <p class="text-amber-200 font-bold text-sm mt-4">**‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÉ‡∏´‡πâ‡∏•‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏î‡πâ‡∏ß‡∏¢**</p>
                        </div>
                        <div class="form-container-animated">
                            <form id="leave-form" class="space-y-6">
                                <div class="slide-in">
                                    <label class="block text-sm font-semibold text-black mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
                                    <select id="leave-user" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></select>
                                </div>
                                <div class="slide-in">
                                    <label class="block text-sm font-semibold text-black mb-4">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤</label>
                                    <div id="leave-type-buttons-new" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3">
                                        <button type="button" class="leave-type-btn px-4 py-3 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:border-purple-400" data-type="‡∏•‡∏≤‡∏Å‡∏¥‡∏à" data-color="purple">‡∏•‡∏≤‡∏Å‡∏¥‡∏à</button>
                                        <button type="button" class="leave-type-btn px-4 py-3 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:border-green-400" data-type="‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô" data-color="green">‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô</button>
                                        <button type="button" class="leave-type-btn px-4 py-3 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:border-red-400" data-type="‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢" data-color="red">‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</button>
                                        <button type="button" class="leave-type-btn px-4 py-3 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:border-purple-400" data-type="‡∏•‡∏≤‡∏Å‡∏¥‡∏à‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô" data-color="purple">‡∏•‡∏≤‡∏Å‡∏¥‡∏à‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</button>
                                        <button type="button" class="leave-type-btn px-4 py-3 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:border-pink-400" data-type="‡∏•‡∏≤‡∏Ñ‡∏•‡∏≠‡∏î" data-color="pink">‡∏•‡∏≤‡∏Ñ‡∏•‡∏≠‡∏î</button>
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <div class="slide-in">
                                        <label class="block text-sm font-semibold text-black mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                                        <input type="date" id="leave-start-date" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                        <label class="block text-sm font-semibold text-black mt-3 mb-2">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</label>
                                        <select id="leave-start-period" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                            <option value="‡πÄ‡∏ï‡πá‡∏°‡∏ß‡∏±‡∏ô">‡πÄ‡∏ï‡πá‡∏°‡∏ß‡∏±‡∏ô</option>
                                            <option value="‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ß‡∏±‡∏ô-‡πÄ‡∏ä‡πâ‡∏≤">‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ß‡∏±‡∏ô-‡πÄ‡∏ä‡πâ‡∏≤</option>
                                            <option value="‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ß‡∏±‡∏ô-‡∏ö‡πà‡∏≤‡∏¢">‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ß‡∏±‡∏ô-‡∏ö‡πà‡∏≤‡∏¢</option>
                                        </select>
                                    </div>
                                    <div class="slide-in">
                                        <label class="block text-sm font-semibold text-black mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
                                        <input type="date" id="leave-end-date" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                        <label class="block text-sm font-semibold text-black mt-3 mb-2">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</label>
                                        <select id="leave-end-period" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                            <option value="‡πÄ‡∏ï‡πá‡∏°‡∏ß‡∏±‡∏ô">‡πÄ‡∏ï‡πá‡∏°‡∏ß‡∏±‡∏ô</option>
                                            <option value="‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ß‡∏±‡∏ô-‡πÄ‡∏ä‡πâ‡∏≤">‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ß‡∏±‡∏ô-‡πÄ‡∏ä‡πâ‡∏≤</option>
                                            <option value="‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ß‡∏±‡∏ô-‡∏ö‡πà‡∏≤‡∏¢">‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ß‡∏±‡∏ô-‡∏ö‡πà‡∏≤‡∏¢</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="slide-in">
                                    <label class="block text-sm font-semibold text-black mb-2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                                    <textarea id="leave-note" rows="4" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
                                </div>
                                <div class="slide-in">
                                    <label class="block text-sm font-semibold text-black mb-2">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</label>
                                    <select id="leave-approver" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"></select>
                                </div>
                                <div class="text-center pt-6 bounce-in">
                                    <button type="submit" class="submit-btn px-8 py-4 text-white font-semibold rounded-lg text-lg">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6 mt-8">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-gray-800">‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô‡∏•‡∏≤ (‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì <span id="leave-summary-fiscal-year"></span>)</h3>
                        <div>
                            <label for="leave-filter-fiscal-year" class="text-sm font-medium text-gray-700 mr-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</label>
                            <select id="leave-filter-fiscal-year"></select>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 p-4 border rounded-lg bg-gray-50">
                        <input type="text" id="summary-search-name" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠..." class="p-2 border rounded-lg col-span-2">
                        <select id="summary-filter-position" class="p-2 border rounded-lg col-span-2"><option value="">‡∏ó‡∏∏‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option><option value="‡πÄ‡∏†‡∏™‡∏±‡∏ä">‡πÄ‡∏†‡∏™‡∏±‡∏ä</option><option value="‡∏à‡∏û‡∏á">‡∏à‡∏û‡∏á</option><option value="‡∏à‡∏ô‡∏ó">‡∏à‡∏ô‡∏ó</option></select>
                    </div>
                    <div class="table-container-no-scroll"><table class="w-full table-auto"><thead class="bg-gray-50 sticky top-0"><tr><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏•‡∏≤ (‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥)</th></tr></thead><tbody id="leave-summary-table"></tbody></table></div>
                    <div id="leave-summary-pagination-controls" class="flex justify-between items-center mt-4">
                        <button id="summary-prev-btn" onclick="changeLeaveSummaryPage(-1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-l disabled:opacity-50" disabled>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
                        <span id="summary-page-info" class="text-sm"></span>
                        <button id="summary-next-btn" onclick="changeLeaveSummaryPage(1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-r disabled:opacity-50">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6 mt-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 p-4 border rounded-lg bg-gray-50">
                        <input type="text" id="records-search-name" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠..." class="p-2 border rounded-lg col-span-1 md:col-span-2">
                        <select id="records-filter-position" class="p-2 border rounded-lg"><option value="">‡∏ó‡∏∏‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option><option value="‡πÄ‡∏†‡∏™‡∏±‡∏ä">‡πÄ‡∏†‡∏™‡∏±‡∏ä</option><option value="‡∏à‡∏û‡∏á">‡∏à‡∏û‡∏á</option><option value="‡∏à‡∏ô‡∏ó">‡∏à‡∏ô‡∏ó</option></select>
                        <input type="date" id="records-filter-start" class="p-2 border rounded-lg">
                        <input type="date" id="records-filter-end" class="p-2 border rounded-lg">
                    </div>
                    <div class="table-container overflow-x-auto"><table class="w-full table-auto"><thead class="bg-gray-50 sticky top-0"><tr><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏≤</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead><tbody id="leave-records-table"></tbody></table></div>
                    <div id="leave-pagination-controls" class="flex justify-between items-center mt-4"><button id="leave-prev-btn" onclick="changeLeavePage(-1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-l disabled:opacity-50" disabled>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button><span id="leave-page-info" class="text-sm"></span><button id="leave-next-btn" onclick="changeLeavePage(1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-r disabled:opacity-50">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button></div>
                </div>
            </div>

            <div id="calendar-content" class="tab-content hidden">
                 <div class="bg-white rounded-2xl shadow-xl p-6 hover-lift slide-in calendar-card">
                    <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
                        <div class="flex items-center gap-4">
                            <button onclick="goToToday()" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-semibold hover:bg-gray-100 transition-colors">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
                            <div class="flex items-center gap-2">
                                <button id="calendar-prev-btn" onclick="navigateCalendar(-1)" class="p-2 rounded-full hover:bg-gray-100 transition-colors"><svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button>
                                <button id="calendar-next-btn" onclick="navigateCalendar(1)" class="p-2 rounded-full hover:bg-gray-100 transition-colors"><svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button>
                            </div>
                            <h3 id="calendar-title" class="text-xl font-semibold text-gray-800 w-48"></h3>
                        </div>
                        <div class="relative">
                            <button id="view-dropdown-btn" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-semibold hover:bg-gray-100 transition-colors flex items-center gap-2">
                                <span id="current-view-text">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
                                <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </button>
                            <div id="view-dropdown-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl z-10 hidden">
                                <a href="#" onclick="changeCalendarView('day')" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">‡∏ß‡∏±‡∏ô</a>
                                <a href="#" onclick="changeCalendarView('week')" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</a>
                                <a href="#" onclick="changeCalendarView('month')" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 bg-gray-50 font-semibold">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</a>
                                <a href="#" onclick="changeCalendarView('year')" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">‡∏õ‡∏µ</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex flex-wrap items-center gap-4 mb-4 pb-4 border-b">
                        <span class="font-semibold text-gray-700">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á:</span>
                        <button onclick="toggleCalendarFilter('fullDay', this)" class="calendar-view-btn filter-btn-fullday active">‡∏•‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</button>
                        <button onclick="toggleCalendarFilter('hourly', this)" class="calendar-view-btn filter-btn-hourly active">‡∏•‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</button>
                        <div class="ml-auto">
                            <select id="calendar-filter-position" onchange="filterCalendarByPosition(this.value)" class="p-2 border rounded-lg text-sm">
                                <option value="">‡∏ó‡∏∏‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option>
                                <option value="‡πÄ‡∏†‡∏™‡∏±‡∏ä">‡πÄ‡∏†‡∏™‡∏±‡∏ä</option>
                                <option value="‡∏à‡∏û‡∏á">‡∏à‡∏û‡∏á</option>
                                <option value="‡∏à‡∏ô‡∏ó">‡∏à‡∏ô‡∏ó</option>
                            </select>
                        </div>
                    </div>
                    <div id="calendar-grid-container"></div>
                    <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4"><div class="flex items-center"><div class="w-4 h-4 sick-leave rounded mr-2"></div><span class="text-sm">‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</span></div><div class="flex items-center"><div class="w-4 h-4 vacation-leave rounded mr-2"></div><span class="text-sm">‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô</span></div><div class="flex items-center"><div class="w-4 h-4 personal-leave rounded mr-2"></div><span class="text-sm">‡∏•‡∏≤‡∏Å‡∏¥‡∏à</span></div><div class="flex items-center"><div class="w-4 h-4 maternity-leave rounded mr-2"></div><span class="text-sm">‡∏•‡∏≤‡∏Ñ‡∏•‡∏≠‡∏î</span></div></div>
                </div>
            </div>

            <div id="register-content" class="tab-content hidden">
                <div class="form-wrapper-animated">
                    <div class="container-animated">
                        <div class="header-animated-green">
                            <h1>üë§ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h1>
                            <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</p>
                        </div>
                        <div class="form-container-animated">
                            <form id="register-form">
                                <div class="form-group-animated">
                                    <label for="register-fullname">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
                                    <input type="text" id="register-fullname" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                                </div>
                                <div class="form-group-animated">
                                    <label for="register-nickname">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
                                    <input type="text" id="register-nickname" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô">
                                </div>
                                <div class="form-group-animated">
                                    <label for="register-position">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                                    <select id="register-position" required>
                                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option>
                                        <option value="‡πÄ‡∏†‡∏™‡∏±‡∏ä">‡πÄ‡∏†‡∏™‡∏±‡∏ä</option>
                                        <option value="‡∏à‡∏û‡∏á">‡∏à‡∏û‡∏á</option>
                                        <option value="‡∏à‡∏ô‡∏ó">‡∏à‡∏ô‡∏ó</option>
                                    </select>
                                </div>
                                <div class="form-group-animated">
                                    <label for="register-pin">‡∏Å‡∏≥‡∏´‡∏ô‡∏î PIN (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 4 ‡∏´‡∏•‡∏±‡∏Å)</label>
                                    <input type="password" id="register-pin" required maxlength="4" pattern="[0-9]{4}" placeholder="‡∏Å‡∏£‡∏≠‡∏Å PIN 4 ‡∏´‡∏•‡∏±‡∏Å">
                                </div>
                                <div class="form-group-animated">
                                    <label for="register-pin-confirm">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô PIN</label>
                                    <input type="password" id="register-pin-confirm" required maxlength="4" pattern="[0-9]{4}" placeholder="‡∏Å‡∏£‡∏≠‡∏Å PIN ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á">
                                </div>
                                <div class="form-group-animated">
                                    <button type="submit" class="submit-btn-animated">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 mt-8"><h3 class="text-xl font-bold text-gray-800 mb-4">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</h3><div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 p-4 border rounded-lg bg-gray-50"><input type="text" id="user-search-name" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠-‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô..." class="p-2 border rounded-lg col-span-2"><select id="user-filter-position" class="p-2 border rounded-lg col-span-2"><option value="">‡∏ó‡∏∏‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option><option value="‡πÄ‡∏†‡∏™‡∏±‡∏ä">‡πÄ‡∏†‡∏™‡∏±‡∏ä</option><option value="‡∏à‡∏û‡∏á">‡∏à‡∏û‡∏á</option><option value="‡∏à‡∏ô‡∏ó">‡∏à‡∏ô‡∏ó</option></select></div><div class="overflow-x-auto"><table class="w-full table-auto"><thead class="bg-gray-50"><tr><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th><th class="px-4 py-3 text-left text-sm font-medium text-gray-700">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead><tbody id="users-table"></tbody></table></div><div id="user-pagination-controls" class="flex justify-between items-center mt-4"><button id="user-prev-btn" onclick="changeUserPage(-1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-l disabled:opacity-50" disabled>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button><span id="user-page-info" class="text-sm"></span><button id="user-next-btn" onclick="changeUserPage(1)" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-r disabled:opacity-50">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button></div></div>
            </div>

            <div id="pin-content" class="tab-content hidden">
                <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white rounded-xl shadow-lg p-6 hover-lift">
                        <h2 class="text-xl font-bold text-gray-800 mb-4 text-center">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô PIN ‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h2>
                        <form id="change-personal-pin-form">
                            <div class="mb-4"><label for="change-pin-user" class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label><select id="change-pin-user" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ..." required></select></div>
                            <div class="mb-4"><label for="old-personal-pin" class="block text-sm font-medium text-gray-700 mb-2">PIN ‡πÄ‡∏î‡∏¥‡∏°</label><input type="password" id="old-personal-pin" class="w-full" required maxlength="4" pattern="\d{4}"></div>
                            <div class="mb-4"><label for="new-personal-pin" class="block text-sm font-medium text-gray-700 mb-2">PIN ‡πÉ‡∏´‡∏°‡πà (4 ‡∏´‡∏•‡∏±‡∏Å)</label><input type="password" id="new-personal-pin" class="w-full" required maxlength="4" pattern="\d{4}"></div>
                            <div class="mb-6"><label for="confirm-new-personal-pin" class="block text-sm font-medium text-gray-700 mb-2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô PIN ‡πÉ‡∏´‡∏°‡πà</label><input type="password" id="confirm-new-personal-pin" class="w-full" required maxlength="4" pattern="\d{4}"></div>
                            <button type="submit" class="w-full bg-blue-600">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™ PIN</button>
                        </form>
                    </div>
            
                    <div id="system-pin-management-container" class="hover-lift">
                        </div>
                </div>
            </div>

            <div id="admin-dashboard-content" class="tab-content hidden">
                <div class="fade-in">
                    <h1 class="text-3xl font-bold text-gray-800 mb-6">üëë Admin Dashboard</h1>
        
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2 space-y-6">
                            <div class="db-card">
                                <div class="db-card-header">
                                    <h2 class="db-card-title">
                                        ‚è≥ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ (<span id="pending-count" class="text-amber-500">0</span>)
                                    </h2>
                                    <div class="flex items-center space-x-2">
                                        <input type="checkbox" id="select-all-pending" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                                        <label for="select-all-pending" class="text-sm text-gray-600">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                    </div>
                                </div>
            
                                <div class="db-filters">
                                    <div class="flex-1">
                                        <label class="filter-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</label>
                                        <div class="filter-btn-group">
                                            <button class="filter-btn active" data-filter-type="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                                            <button class="filter-btn" data-filter-type="leave">‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤</button>
                                            <button class="filter-btn" data-filter-type="hourly">‡∏•‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</button>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <label for="pending-approver-filter" class="filter-label">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥:</label>
                                        <select id="pending-approver-filter" class="filter-select"></select>
                                    </div>
                                </div>
                                
                                <div class="mt-4">
                                     <button id="batch-approve-btn" class="batch-approve-button" disabled>
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                                        ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                                    </button>
                                </div>
            
                                <div id="pending-requests-list" class="db-list mt-4"></div>
                            </div>
                        </div>
        
                        <div class="space-y-6">
                            <div class="db-card">
                                <h2 class="db-card-title">
                                    ‚òÄÔ∏è ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (<span id="today-date-display"></span>)
                                </h2>
                                <div id="today-on-leave-list" class="db-list"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="mt-12 bg-white border-t">
        <div class="container mx-auto px-6 py-6 text-center text-sm text-gray-600">
            ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏†‡∏Å.‡∏ò‡∏µ‡∏£‡πÄ‡∏î‡∏ä ‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ - ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå
        </div>
    </footer>

    <div id="backup-modal" class="hidden fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50">
        <div class="bg-white p-6 rounded-xl w-full max-w-sm shadow-2xl">
            <h2 class="text-xl font-bold mb-4 text-center text-gray-800">Backup ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>

            <button onclick="downloadHourlyJSON()" 
                class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg mb-3 transition-colors">
                ‚è∞ ‡∏•‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (JSON)
            </button>

            <button onclick="downloadNormalLeaveJSON()" 
                class="w-full bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg mb-3 transition-colors">
                üìÑ ‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ (JSON)
            </button>

            <button onclick="exportAllDataToExcel()"
                class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg transition-colors">
                üìä Backup Excel
            </button>

            <button onclick="closeBackupMenu()"
                class="mt-4 w-full bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 rounded-lg transition-colors">
                ‡∏õ‡∏¥‡∏î
            </button>
        </div>
    </div>

    <script type="module" src="script.js"></script>

</body>
</html>
